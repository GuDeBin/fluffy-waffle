# 初学者的 Linux 命令行简易教程

翻译自[Ubuntu 教程](https://ubuntu.com/tutorials/command-line-for-beginners#1-overview)

因为反复看这篇教程，其中一些操作和原则非常有用，这也是我坚定使用 Ubuntu 的原因，它对于新手真好。

## 概述

Linux 命令行是计算机的文本界面。通常被称为外壳，终端，控制台，提示符或各种其他名称，它可能看起来很复杂且使用起来令人困惑。然而，从网站复制和粘贴命令的能力，加上命令行提供的强大功能和灵活性，意味着在尝试在线遵循说明时使用它可能是必不可少的，包括这个网站上的许多说明！

本教程将教您一些命令行的历史，然后引导您完成一些实践练习，以熟悉一些基本的命令和概念。我们将假设没有先验知识，但到最后，我们希望您下次面对一些以“打开终端”开头的说明时会感到更舒服一些。

最初由[peppertop](https://github.com/peppertop)撰写。

您将学到什么

- 命令行的小历史
- 如何从您自己的计算机访问命令行
- 如何执行一些基本的文件操作
- 其他一些有用的命令
- 如何将命令链接在一起以制作更强大的工具
- 使用管理员权限的最佳方式

你需要什么

- 运行 Ubuntu 或其他版本 Linux 的计算机

每个 Linux 系统都包含这样或那样的命令行。本教程包括 Ubuntu 18.04 的一些特定步骤，但无论您的 Linux 发行版如何，大多数内容都应该有效。

## 简短的历史课

在计算机工业的形成时期，早期的操作系统之一被称为 Unix。它被设计成在大型计算机上运行的多用户系统，用户可以通过单独的终端远程连接到它。按照现代标准，这些终端是相当基础的:只有键盘和屏幕，没有能力在本地运行程序。相反，他们只需向服务器发送击键，并在屏幕上显示接收到的任何数据。没有鼠标，没有花哨的图形，甚至没有任何颜色的选择。一切都以文本的形式发送，也以文本的形式接收。因此，显然，在大型机上运行的任何程序都必须产生文本作为输出，并接受文本作为输入。

与图形相比，文本占用的资源非常少。即使是在 20 世纪 70 年代的机器上，在极慢的网络连接(以今天的标准)上运行数百个终端，用户仍然能够快速有效地与程序交互。为了减少击键次数，命令也保持得非常简洁，从而进一步加快了人们使用终端的速度。这种速度和效率是这种文本界面至今仍被广泛使用的原因之一。

当用户通过终端登录到 Unix 大型机时，仍然需要管理文件管理任务，而现在您可以通过鼠标和几个窗口来完成这些任务。无论是创建文件、重命名文件、将其放入子目录或在磁盘上移动它们，70 年代的用户都可以通过文本界面完成所有事情。

每个任务都需要自己的程序或命令:一个更改目录(cd)，另一个列出目录的内容(ls)，第三个重命名或移动文件(mv)，等等。为了协调每一个程序的执行，用户将连接到一个主程序，然后可以使用该主程序启动其他任何程序。通过包装用户的命令，这个众所周知的“shell”程序可以为任何命令提供通用功能，例如从一个命令直接传递数据到另一个命令的能力，或者使用特殊的通配符一次性处理大量名称相似的文件的能力。用户甚至可以编写简单的代码(称为“shell 脚本”)，这些代码可用于自动化长序列的 shell 命令，以便使复杂的任务更简单。最初的 Unix shell 程序刚刚被调用，但多年来它已经被扩展和取代，所以在现代 Linux 系统上，您最有可能使用的 shell 是。不要太担心您使用的是哪个 shell，本教程中的所有内容都适用于几乎所有 shell

Linux 可以说是 Unix 的后裔。Linux 的核心部分被设计成与 Unix 系统类似的行为，因此大多数旧 shell 和其他基于文本的程序都能在 Linux 上运行得非常愉快。理论上，你甚至可以将一个上世纪 70 年代的老式终端连接到一个现代 Linux 机顶盒上，并通过它访问外壳。但如今，使用软件终端更为普遍:同样是 unix 风格的文本界面，但在窗口中运行，与图形程序并排运行。让我们看看你自己是如何做到的!

## 开启终端

在 Ubuntu 18.04 系统中，你可以通过点击屏幕左上方的 Activities 项目，然后输入“terminal”、“command”、“prompt”或“shell”的前几个字母来找到终端的启动器。是的，开发人员已经用所有最常见的同义词设置了启动器，所以您找到它应该没有问题。

![ubuntu18.04的终端启动器](./Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/Terminal%20launcher%20in%20Ubuntu%2018.04_2_690x175.png)

其他版本的 Linux，或者其他版本的 Ubuntu，通常会有一个终端启动器，位于与其他应用程序启动器相同的位置。它可能隐藏在子菜单中，或者你可能必须从启动器中搜索它，但它很可能就在那里的某个地方。

如果您找不到启动器，或者您只是想以更快的方式启动终端，大多数 Linux 系统使用相同的默认键盘快捷方式来启动它:Ctrl-Alt-T。

无论如何启动终端，最终都应该看到一个看起来相当沉闷的窗口，顶部有一些“奇怪”的文本，就像下图一样。根据您的 Linux 系统的不同，颜色可能不相同，文本也可能显示不同的内容，但是具有大文本区域(大部分为空)的窗口的总体布局应该是相似的。

![在Ubuntu18.0打开一个新的终端窗口](./Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/A%20new%20terminal%20window%20in%20Ubuntu%2018.04_2_690x300.png)

让我们运行第一个命令。在窗口中单击鼠标以确保这就是您击键的位置，然后键入以下命令，全部用小写字母，然后按 Enter 或 Return 键运行该命令。

```sh
pwd
```

您应该看到打印出来的目录路径(可能类似于/home/YOUR_USERNAME)，然后是该“奇怪”文本的另一个副本。

![](./Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/Result%20of%20running%20the%20pwd%20command_2_690x300.png)

在深入了解该命令实际做了什么之前，这里需要了解一些基础知识。首先，当您键入一个命令时，它会与“奇怪”文本出现在同一行中。这个文本是告诉你计算机准备好接受命令了，这是计算机提示你的方式。实际上，它通常被称为提示符，您有时可能会看到“弹出提示符”、“打开命令提示符”、“在 bash 提示符”或类似的指示。它们都是要求你打开终端进入外壳的不同方式。

关于同义词的主题，另一种看待提示符的方法是，在终端中有一行用于输入命令。一个命令行，如果你愿意。同样，如果您在本教程的标题中看到“命令行”的提及，那么这只是在另一种方式中谈论在终端中运行的 shell。

第二件要理解的事情是，当您运行一个命令时，它产生的任何输出通常会直接打印在终端上，然后在它完成后会显示另一个提示符。有些命令可以输出大量文本，而其他命令将静默操作，根本不会输出任何内容。如果您运行一个命令，而另一个提示立即出现，请不要惊慌，因为这通常意味着命令成功了。如果你回想一下 20 世纪 70 年代终端缓慢的网络连接，那些早期的程序员认为，如果一切正常，他们还不如什么都不说来节省一些宝贵的数据传输字节。

**案例的重要性**

在命令行中输入时要特别注意大小写。输入 PWD 而不是 pwd 将产生错误，但有时错误的情况会导致命令运行，但没有达到您的预期效果。我们将在下一页中更多地讨论这种情况，但是现在，只要确保在显示的情况下键入所有以下行。

### 路径目录

现在来谈谈命令本身。pwd 是“打印工作目录”的缩写。它所做的只是打印出 shell 的当前工作目录。但是什么是工作目录呢?

需要理解的一个重要概念是，shell 有一个默认位置的概念，任何文件操作都将发生在该位置。这是它的工作目录。如果您试图创建新文件或目录，查看现有文件，甚至删除它们，shell 将假定您正在当前工作目录中查找它们，除非您采取其他步骤进行指定。因此，了解 shell 在任何时候“位于”哪个目录是非常重要的，毕竟，从错误的目录中删除文件可能是灾难性的。如果您有任何疑问，pwd 命令将确切地告诉您当前工作目录是什么。

您可以使用 cd 命令更改工作目录，cd 是“change directory”的缩写。试着输入以下内容:

```sh
cd /
pwd
```

注意，目录分隔符是正斜杠(“/”)，而不是您在 Windows 或 DOS 系统中习惯使用的反斜杠

现在您的工作目录是“/”。如果你有 Windows 背景，你可能习惯了每个硬盘都有自己的字母，你的主硬盘通常是“C:”。类 unix 系统不会这样分割驱动器。相反，它们有一个统一的文件系统，各个驱动器可以附加(“挂载”)到文件系统中最有意义的任何位置。“/”目录通常被称为根目录，它是统一文件系统的基础。从那里，所有其他的分支形成一个目录和子目录的树。

**root 的多种含义**

注意:尽管“/”目录有时被称为根目录，但单词“root”有另一个含义。root 也是自 Unix 早期以来一直用于超级用户的名称。超级用户，顾名思义，拥有比普通用户更多的功能，因此可以很容易地用键入错误的命令造成严重破坏。我们将在第 7 节中更多地讨论超级用户帐户。现在您只需要知道“root”这个词在 Linux 世界中有多种含义，因此上下文非常重要。

从根目录，以下命令将移动到“home”目录(它是“/”的直接子目录):

```sh
cd home
pwd
```

要上移到父目录，在本例中是返回到" / "，在更改目录时使用两个点的特殊语法(注意 cd 和..之间的空格)，不像在 DOS 中，你不能只输入 cd..作为一个命令):

```sh
cd ..
pwd
```

输入 cd 是返回你的主目录的快捷方式:

```sh
cd
pwd
```

你也可以用..如果你需要通过多个级别的父目录向上移动不止一次:

```sh
cd ../..
pwd
```

注意，在前面的示例中，我们描述了通过目录的路由。我们使用的路径意味着“从工作目录开始，移动到父目录/从新位置再次移动到父目录”。因此，如果我们想从我们的主目录直接到“etc”目录(直接在文件系统的根目录中)，我们可以使用以下方法:

```sh
cd
pwd

cd ../../etc
pwd
```

相对路径和绝对路径

到目前为止，我们看到的大多数示例都使用相对路径。也就是说，您最终到达的位置取决于您当前的工作目录。考虑尝试 cd 到“etc”文件夹。如果你已经在根目录下，那就没问题:

```sh
cd /
pwd
cd etc
pwd
```

但是如果是在主目录中呢?

```sh
cd
pwd
cd etc
pwd
```

在运行最后一个 pwd 之前，您将看到一个错误提示“没有这样的文件或目录”。通过指定目录名称或使用..会有不同的效果取决于你从哪里开始。该路径只相对于您的工作目录有意义。

但是我们已经看到了两个绝对的命令。无论您当前的工作目录是什么，它们都具有相同的效果。第一个是当你运行 cd 直接到你的主目录时。第二个是当您使用 cd /切换到根目录时。事实上，任何以正斜杠开头的路径都是绝对路径。您可以将其理解为“切换到根目录，然后从那里遵循路由”。这为我们提供了一种切换到 etc 目录的更简单的方法，无论我们当前在文件系统的哪个位置:

```sh
cd
pwd
cd /etc
pwd
```

它还提供了另一种方法来返回您的主目录，甚至返回其中的文件夹。假设您想从磁盘上的任何位置直接进入“Desktop”文件夹(注意大写的“D”)。在下面的命令中，你需要用你自己的用户名替换 USERNAME，如果你不确定，whoami 命令会提醒你你的用户名:

```sh
whoami
cd /home/USERNAME/Desktop
pwd
```

还有一个方便的快捷方式是绝对路径。正如您所看到的，在路径的开头使用“/”意味着“从根目录开始”。在路径的开头使用波浪号(“~”)同样意味着“从我的主目录开始”。

```sh
cd ~
pwd

cd ~ /Desktop
pwd
```

现在，提示符中奇怪的文本可能有点意义了。当您在文件系统中移动时，您是否注意到它的变化?在 Ubuntu 系统中，它会显示你的用户名，你的计算机的网络名称和当前的工作目录。但如果在主目录中的某个位置，它将使用“~”作为缩写。让我们稍微浏览一下文件系统，并在执行过程中注意一下提示:

```sh
cd
cd /
cd ~ /Desktop
cd /etc
cd /var/log
cd . .
cd
```

到现在为止，您一定已经厌倦了在文件系统中来回移动，但是在我们继续创建一些新文件夹和文件时，充分理解绝对路径和相对路径将是非常宝贵的!

## 创建文件夹和文件

在本节中，我们将创建一些实际的文件。为了避免不小心踩到你的任何真实文件，我们将开始创建一个新目录，远离你的主文件夹，这将作为一个更安全的环境，在其中进行实验:

```sh
mkdir /tmp/tutorial
cd /tmp/tutorial
```

注意这里使用了绝对路径，以确保教程目录是在/tmp 中创建的。如果开头没有正斜杠，mkdir 命令将尝试在当前工作目录中查找 tmp 目录，然后尝试在其中创建一个教程目录。如果找不到 tmp 目录，命令就会失败。

如果你没有猜到，mkdir 是“make directory”的缩写。现在我们已经安全地进入了测试区域(如果不确定，请再次使用 pwd 检查)，让我们创建一些子目录:

```sh
mkdir dir1 dir2 dir3
```

这个命令有点不同。到目前为止，我们只看到单独工作的命令(cd、pwd)或后面有一个项的命令(cd /、cd ~/Desktop)。但是这次我们在 mkdir 命令之后添加了三个东西。这些东西称为形参或实参，不同的命令可以接受不同数量的实参。mkdir 命令要求至少有一个参数，而 cd 命令可以使用 0 或 1 个参数，但不能更多。看看当你试图向命令传递错误数量的参数时会发生什么:

```sh
mkdir
cd /etc ~/Desktop
```

回到我们的新目录。上面的命令将在文件夹中创建三个新的子目录。让我们用 ls (list)命令来看看它们:

```sh
ls
```

如果你已经执行了最后几个命令，你的终端应该看起来像这样:

![The terminal, after running mkdir and ls](./Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/The%20terminal%2C%20after%20running%20mkdir%20and%20ls.png)

注意，mkdir 在一个目录中创建了所有文件夹。它没有在 dir2 和 dir1 中创建 dir3，也没有创建任何其他嵌套结构。但有时能够做到这一点是很方便的，mkdir 确实有一个方法:

```sh
mkdir -p dir4/dir5/dir6
ls
```

这一次，您将看到只有 dir4 被添加到列表中，因为 dir5 在其中，dir6 在其中。稍后我们将安装一个有用的工具来可视化结构，但你已经有足够的知识来确认它:

```sh
cd dir4
ls
cd dir5
ls
cd ../..
```

我们使用的“-p”被称为选项或开关(在本例中它的意思是“也创建父目录”)。选项用于修改命令的操作方式，允许单个命令以各种不同的方式执行。不幸的是，由于历史和人性的特性，选项可以在不同的命令中采用不同的形式。您经常会看到它们是前面加一个连字符的单个字符(如本例)，或者是前面加两个连字符的较长的单词。单字符形式允许组合多个选项，尽管不是所有命令都接受这一点。更让人困惑的是，有些命令根本没有清楚地标识它们的选项，而某些东西是否为选项完全由参数的顺序决定!你不需要担心所有的可能性，只要知道选择的存在，它们可以采取几种不同的形式。例如，以下都是完全相同的意思:

```sh
#不要输入这些，它们只是为了演示的目的
mkdir --parents --verbose dir4/dir5
mkdir -p --verbose dir4/dir5
mkdir -p -v dir4/dir5
mkdir -pv dir4/dir5
```

现在我们知道了如何通过将多个目录作为单独的参数传递给 mkdir 命令来创建多个目录。但是假设我们想要创建一个名称中有空格的目录?让我们试一试:

```sh
mkdir anther folder
ls
```

你可能甚至不需要输入这个就能猜到会发生什么:两个新文件夹，一个叫做 **_anther_**，另一个叫做 **_folder_**。如果希望在目录或文件名中使用空格，则需要对它们进行*转义*。别担心，没人会越狱;*转义*是一个计算术语，指使用特殊代码告诉计算机将特定字符与正常字符区别对待。输入以下命令，尝试用不同的方法创建名称为空格的文件夹:

```sh
mkdir "folder 1"
mkdir 'folder 2'
mkdir folder\ 3
mkdir "folder 4" "folder 5"
mkdir -p "folder 6"/"folder 7"
ls
```

尽管可以使用命令行处理名称中有空格的文件和文件夹，但是需要用引号或反斜杠对它们进行转义，这使事情变得有点困难。您通常可以通过文件名来判断一个人经常使用命令行:他们倾向于坚持使用字母和数字，并使用下划线(“\_”)或连字符(“-”)而不是空格。

### 使用重定向创建文件

我们的演示文件夹开始看起来充满了目录，但是有些缺少文件。让我们通过重定向命令的输出来补救这个问题，这样它就不会被打印到屏幕上，而是以一个新文件的形式结束。首先，提醒自己 ls 命令当前显示的内容:

```sh
ls
```

假设我们希望将该命令的输出捕获为文本文件，以便我们可以进一步查看或操作。我们所需要做的就是在命令行末尾加上大于号字符(" > ")，后面跟着要写入的文件名:

```sh
Ls > output.txt
```

这一次没有任何东西打印到屏幕上，因为输出被重定向到我们的文件。如果您只是单独运行 ls，您应该会看到 output.txt 文件已经创建。我们可以使用 cat 命令查看它的内容:

```sh
cat output.txt
```

好了，它和之前显示在屏幕上的不完全一样，但它包含了所有相同的数据，而且它的格式对进一步处理更有用。让我们看看另一个命令 echo:

```sh
echo "this is a test"
```

是的，echo 只是再次打印出它的参数(因此得名)。但是将它与重定向结合起来，你就有了一种轻松创建小测试文件的方法:

```sh
echo "This is a test" > test_1.txt
echo "This is a second test" > test_2.txt
echo "This is a third test" > test_3.txt
ls
```

您应该对每个文件进行 cat 检查，以检查其内容。但是 cat 不仅仅是一个文件查看器——它的名字来自于“concatenate”，意思是“连接在一起”。如果你传递多个文件名给 cat，它会一个接一个地输出每个文件名，作为单个文本块:

```sh
cat test_1.txt test_2.txt test_3.txt
```

如果要将多个文件名传递给单个命令，如果文件名相似，有一些有用的快捷方式可以节省大量输入。可以使用问号(“?”)表示文件名中的“任何单个字符”。星号(“\*”)可以用来表示“零个或多个字符”。这些字符有时称为“通配符”字符。一些例子可能会有所帮助，以下命令都做同样的事情:

```sh
cat test*1.txt test_2.txt test_3.txt
cat test* ? . txt
cat test\_ \*
```

**需要更多转义**

您可能已经猜到了，此功能还意味着您需要使用?或者其中也有\*个字符。如果想从命令行操作文件名，通常最好避免文件名中的任何标点符号。

如果查看 ls 的输出，您会注意到唯一以“t”开头的文件或文件夹是我们刚刚创建的三个测试文件，所以您甚至可以进一步简化最后一个命令为 cat t\*，意思是“连接所有名称以 t 开头、后面有零个或多个其他字符的文件”。让我们使用这个功能将所有的文件连接到一个新文件中，然后查看它:

```sh
cat t* > combined.txt
cat combined.txt
```

如果我们第二次运行这两个命令，您认为会发生什么?因为文件已经存在，计算机会报错吗?它会将文本附加到文件中，从而包含两个副本吗?还是会完全取代它?试着看看会发生什么，但是为了避免再次输入命令，可以使用向上箭头和向下箭头键来来回移动您使用过的命令的历史记录。按几次向上箭头到达第一只 cat，然后按 Enter 运行它，然后重复同样的操作到达第二只 cat。

如您所见，文件看起来是一样的。这并不是因为它保持原样，而是因为 shell 在将 cat 命令的输出写入文件之前清除了文件的所有内容。因此，在使用重定向时应该格外小心，以确保不会意外地覆盖所需的文件。如果你确实想追加而不是替换文件的内容，请使用>>:

```sh
cat t\* >> combined.txt
echo“我追加了一行!”> > combined.txt
cat combined.txt
```

为了方便起见，使用向上箭头再重复第一个 cat 几次，也许还可以添加一些任意的 echo 命令，直到文本文档非常大，以至于在使用 cat 显示时无法一次性放入终端。为了查看整个文件，我们现在需要使用一个不同的程序，称为分页器(因为它每次只显示一个“页”)。以前的标准分页器被称为 more，因为它在每个页面的底部放置一行“- more -”文本，表示您还没有阅读所有内容。如今，有一种更好的寻呼机可以替代它:因为它替代的更多，程序员决定称呼它为 less。

```sh
less combined.txt
```

当通过 less 查看文件时，您可以使用向上箭头，向下箭头，页面向上，页面向下，Home 和结束键来移动您的文件。给他们一个尝试，看看他们之间的区别。查看完文件后，按 q 退出 less 并返回到命令行。

关于 case 的注意事项
Unix 系统是区分大小写的，也就是说，它们认为" A.txt "和" A.txt "是两个不同的文件。如果你运行下面的代码行，你会得到三个文件:

echo“小写”> a.t txt
echo“大写”> A.TXT
echo“混合情况”> a.t txt
一般情况下，应该尽量避免创建名称仅随大小写而变化的文件和文件夹。它不仅有助于避免混淆，而且还可以防止在使用不同的操作系统时出现问题。例如，Windows 是不区分大小写的，因此它会将上面的三个文件名视为一个文件，这可能会导致数据丢失或其他问题。

您可能会倾向于按“大写锁定”键，并将所有文件名都使用大写。但是绝大多数 shell 命令都是小写的，因此在键入时必须频繁地打开或关闭它。大多数经验丰富的命令行用户倾向于主要坚持用小写字母命名他们的文件和目录，这样他们很少需要担心文件名冲突，或名称中的每个字母使用哪种大小写。
